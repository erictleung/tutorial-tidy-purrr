---
title: "From Messy to Tidy: Intro to Data Carpentry in R"
author: "Eric Leung and Ted Laderas"
date: "February 16th, 2017"
output:
  ioslides_presentation:
    fig_caption: yes
    highlight: pygments
---

```{r}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```

## Overview

  - What is Tidy Data?
  - A Simple Example: Going from Excel to Tidy Data to Plotting
  - The Tidyverse: Verbs for Data manipulation

## What is Tidy Data?

[According to Jeff Leek](https://leanpub.com/datastyle), Tidy data has the following properties:

1. Each variable should have its own column.
2. Each observation of that variable should be in its own row
3. One table for each "kind" of variable
4. Multiple tables should have an identifier column to let you join them together.

## Why Tidy Data?



## Tidyverse {.columns-2}

**Core Packages**

- `ggplot2` (graphics)
- `tibble` (data frames and tables)
- `tidyr` (make tidy)
- `readr` (read in tabular formats)
- `purrr` (functional programming)
- `dplyr` (manipulate data)

<img src="./images/tidy-logos.png" style="height: auto; width: 100%">


## Overall Workflow

![Data science exploration general workflow](./images/data-science.png)

We'll follow this workflow with a use case of reading in an Excel document,
cleaning it up, and visualizing it.

```{r Import tidyverse}
library(tidyverse) # Import tidyverse
```


## Read in Data

![Import and wrangle data](./images/data-science-wrangle.png)


## Sample Dataset A

![Dataset A](./images/datasetA.png)


## Sample Dataset B

![Dataset B](./images/datasetB.png)


## Let's Read in the Data

```{r Read in data}
# Using the readxl package to read in Excel files
library(readxl)
rawData <- read_excel(path = "data/all_data.xlsx")
```


## Take a Look at the Data

```{r}
head(rawData) # Tibble shows small bit of the data
```


## Another Way to Look at Data

```{r}
rawData
```


## Start Exploring the Data!

![](./images/data-science-explore.png)


## Visualize and Communicate Findings

![](./images/data-science-communicate.png)


## Four Basic Principles to Tidyverse

1. Reuse existing data structures
2. Make simple function
3. Embrace functional programming
4. Design for humans

**Source**:

https://cran.r-project.org/web/packages/tidyverse/vignettes/manifesto.html

## 1. Reuse existing data structures

1. **Reuse existing data structures**
2. Make simple functions
3. Embrace functional programming
4. Design for humans

- Re-use pre-existing data structures
- Many packages (e.g. ggplot2, dplyr) use rectangular data
- Use data frames or tibbles


## 2. Make simple functions

1. Reuse existing data structures
2. **Make simple functions**
3. Embrace functional programming
4. Design for humans

- The pipe character in R is `%>%`
- Functions should be "simple" and do one thing well
- Avoid mixing side-effects
    - Returns object OR
    - Side-effect i.e. changes the input data
- Function names should be verbs


## 3. Embrace functional programming


1. Reuse existing data structures
2. Make simple functions
3. **Embrace functional programming**
4. Design for humans

- R is a functional language
- Immutable objects == objects that don't change
- In other words, if you want to make changes, do a copy-on-modify
- Use tools that abstract out `for` loops e.g. apply methods or mapping


## 4. Design for humans

1. Reuse existing data structures
2. Compose simple functions with the pipe
3. Embrace functional programming
4. **Design for humans**

- Other people will read your code
- Be considerate of others reading your code
- Compute time is secondary to thinking time
- Things to do:
    - Invest time in good names
    - Be explicit and possibly long with names


## Tidyverse Part 1

- `broom` (convert statistical objects to tidy data)
- `dplyr` (easily tidy data)
- `forcats` (work with categorical variables)
- `ggplot2` (create elegant data visualizations)
- `haven` (import and export SPSS, Stata, and SAS)
- `httr` (work with URLs and HTTP)
- `hms` (pretty time of day)
- `jsonlite` (robust JSON parser)
- `lubridate` (deal with dates easier)

## Tidyverse Part 2

- `magrittr` (pipe)
- `modelr` (modeling functions)
- `purrr` (functional programming)
- `readr` (read tabular data)
- `readxl` (read Excel data)
- `stringr` (manipulate strings)
- `tibble` (simple data frames)
- `rvest` (web scrapping tools)
- `tidyr` (easily tidy data)
- `xml2` (parse XML files)


## R for Data Science {.columns-2}

Website: http://r4ds.had.co.nz


<img src="./images/cover.png" style="height: 70%; width: 80%">


## Questions?

<img src="./images/rstudio-hex-purrr.png" style="height: auto; width: 25%">


## Resources

- https://jennybc.github.io/purrr-tutorial/index.html
- https://github.com/tidyverse/tidyverse
- https://cran.r-project.org/web/packages/tidyverse/vignettes/manifesto.html
