---
title: "Using tidyverse to clean and manipulate data"
author: "Eric Leung and Ted Laderas"
date: "February 16th, 2017"
output:
  ioslides_presentation:
    highlight: pygments
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
```

## Overview

  - What is Tidy Data?
  - A Simple Example: Going from Excel to Tidy Data to Plotting
  - The Tidyverse: Verbs for Data manipulation

## What is Tidy Data?

[According to Jeff Leek](https://leanpub.com/datastyle), tidy data has the following properties:

1. Each variable should have its own column.
2. Each observation of that variable should be in its own row
3. One table for each "kind" of variable
  - Microarray Data
  - Sample Table & Demographics
4. Multiple tables should have an identifier column to let you join them together.

## Why Tidy Data?

In short, most R packages expect tidy data in one form or another. 

##Long versus Wide Data



## Tidyverse {.columns-2}

**Core Packages**

- `ggplot2` (graphics)
- `tibble` (data frames and tables)
- `tidyr` (make tidy)
- `readr` (read in formats)
- `purrr` (functional programming)
- `dplyr` (manipulate data)


<img src="./images/tidy-logos.png" style="height: auto; width: 100%">


## All 20 Imported Packages (`library()`) {.columns-2}

### Part 1

- `broom`
- `dplyr` (H, RStudio)
- `forcats` (H, RStudio)
- `ggplot2` (H, RStudio)
- `haven` (H, RStudio)
- `httr` (H, RStudio)
- `hms`
- `jsonlite`
- `lubridate` (H)

### Part 2

- `magrittr` (H)
- `modelr` (H, RStudio)
- `purrr` (H, RStudio)
- `readr` (H, RStudio)
- `readxl` (H, RStudio)
- `stringr` (H, RStudio)
- `tibble` (H, RStudio)
- `rvest` (H, RStudio)
- `tidyr` (H, RStudio)
- `xml2` (H, RStudio)


## R for Data Science {.columns-2}

Website: http://r4ds.had.co.nz

<img src="./images/cover.png" style="height: 70%; width: 80%">


## Four Basic Principles to Tidyverse

1. Reuse existing data structures
2. Compose simple functions with the pipe
3. Embrace functional programming
4. Design for humans

**Source**:

https://cran.r-project.org/web/packages/tidyverse/vignettes/manifesto.html

## 1. Reuse existing data structures

- Re-use pre-existing data structures
- Many packages (e.g. ggplot2, dplyr) use rectangular data
- Use data frames or tibbles


## 2. Compose simple functions with the pipe

- The pipe character in R is `%>%`
- Functions should be "simple" and do one thing well
- Avoid mixing side-effects
    - Returns object OR
    - Side-effect i.e. changes the input data
- Function names should be verbs


## 3. Embrace functional programming

- R is a functional language
- Immutable objects == objects that don't change
- In other words, if you want to make changes, do a copy-on-modify
- Use tools that abstract out `for` loops e.g. apply methods or mapping


## 4. Design for humans

- Other people will read your code
- Be considerate of others reading your code
- Compute time is secondary to thinking time
- Things to do:
    - Invest time in good names
    - Be explicit and possibly long with names


## Questions?

<img src="./images/rstudio-hex-purrr.png" style="height: auto; width: 25%">


## Resources

- https://jennybc.github.io/purrr-tutorial/index.html
- https://github.com/tidyverse/tidyverse
- https://cran.r-project.org/web/packages/tidyverse/vignettes/manifesto.html
